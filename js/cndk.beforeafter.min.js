$.fn.cndkbeforeafter=function(e){var t=$.extend({mode:"hover",showText:!0,beforeText:"BEFORE",beforeTextPosition:"bottom-left",afterText:"AFTER",afterTextPosition:"bottom-right",seperatorWidth:"4px",seperatorColor:"#000000",hoverEffect:!0},e),r=this,f=new Image;f.src=$(this).find(">div").eq(0).find('div[data-type="before"] img').attr("src"),f.onload=function(){!function(e){e.each(function(){var e=$(this).find(">div>div").length;e<=1&&console.log("(cndk.beforeafter.js) Error ->Â No before-after images found.");var r=$(this);if(r.addClass("cndkbeforeafter cndkbeforeafter-root"),r.append("<div class='cndkbeforeafter-seperator' style='width:"+t.seperatorWidth+" ;background:"+t.seperatorColor+"'></div>"),r.append("<div class='cndkbeforeafter-container'></div>"),1==t.hoverEffect&&r.addClass("cndkbeforeafter-hover"),1==t.showText){var f=null==$(this).find(">div").eq(0).find('div[data-type="before"]').attr("data-title")?t.beforeText:$(this).find(">div").eq(0).find('div[data-type="before"]').attr("data-title"),d=null==$(this).find(">div").eq(0).find('div[data-type="after"]').attr("data-title")?t.afterText:$(this).find(">div").eq(0).find('div[data-type="after"]').attr("data-title");r.append("<div class='cndkbeforeafter-item-before-text cndkbeforeafter-"+t.beforeTextPosition+"'>"+f+"</div>"),r.append("<div class='cndkbeforeafter-item-after-text cndkbeforeafter-"+t.afterTextPosition+"'>"+d+"</div>")}for(i=0;i<e;i++){var a=$(this).find(">div").eq(i).find('div[data-type="before"]'),n=$(this).find(">div").eq(i).find('div[data-type="before"] img');n.addClass("cndkbeforeafter-item-before"),a.addClass("cndkbeforeafter-item-before-c"),a.css("overflow","hidden"),a.css("z-index","2");var o=$(this).find(">div").eq(i).find('div[data-type="after"]'),s=$(this).find(">div").eq(i).find('div[data-type="after"] img');s.addClass("cndkbeforeafter-item-after"),o.addClass("cndkbeforeafter-item-after-c"),o.css("z-index","1");var c=n.width(),b=n.height(),h=$(this).parent().width();h<c&&(b/=c/h,c=h,n.css("width",c+"px"),s.css("width",c+"px")),$(this).find(">div").eq(0).addClass("cndkbeforeafter-item"),$(this).find(">div").eq(0).css("height",b+"px"),c<200&&($(this).find(".cndkbeforeafter-item-after-text").addClass("cndkbeforeafter-extra-small-text cndkbeforeafter-extra-small-text-after"),$(this).find(".cndkbeforeafter-item-before-text").addClass("cndkbeforeafter-extra-small-text cndkbeforeafter-extra-small-text-before")),a.css("width","50%"),o.css("width","50%"),$(".cndkbeforeafter-seperator").css("left","50%"),r.css("width",c+"px"),r.css("height",b+"px")}if("hover"==t.mode)$(r).find(".cndkbeforeafter-seperator, .cndkbeforeafter-item > div").addClass("cndkbeforeafter-hover-transition"),$(r).mousemove(function(e){var t=$(this).offset(),f=parseInt(e.pageX-t.left),d=100*f/parseInt(r.width());$(this).find(".cndkbeforeafter-item-before-c").css("width",d+"%"),$(this).find(".cndkbeforeafter-item-after-c").css("width",100-d+"%"),$(this).find(".cndkbeforeafter-seperator").css("left",d+"%")}).mouseleave(function(){$(this).find(".cndkbeforeafter-item-after-c").css("width","50%"),$(this).find(".cndkbeforeafter-item-before-c").css("width","50%"),$(this).find(".cndkbeforeafter-seperator").css("left","50%")});else if("drag"==t.mode){$(r).find(".cndkbeforeafter-seperator, .cndkbeforeafter-item > div").addClass("cndkbeforeafter-drag-transition"),$(r).click(function(e){var t=$(this).offset(),f=parseInt(e.pageX-t.left),d=100*f/parseInt(r.width());$(this).find(".cndkbeforeafter-item-before-c").css("width",d+"%"),$(this).find(".cndkbeforeafter-item-after-c").css("width",100-d+"%"),$(this).find(".cndkbeforeafter-seperator").css("left",d+"%")});var v=!1,p=r;p.find(".cndkbeforeafter-seperator").on("mousedown",function(e){v=!0,p.find(".cndkbeforeafter-seperator, .cndkbeforeafter-item > div").removeClass("cndkbeforeafter-drag-transition"),p.mousemove(function(e){if(v){var t=p.offset(),f=parseInt(e.pageX-t.left),d=100*f/parseInt(r.width());p.find(".cndkbeforeafter-item-before-c").css("width",d+"%"),p.find(".cndkbeforeafter-item-after-c").css("width",100-d+"%"),p.find(".cndkbeforeafter-seperator").css("left",d+"%")}})}),p.find(".cndkbeforeafter-seperator").on("mouseup",function(e){v=!1,p.find(".cndkbeforeafter-seperator, .cndkbeforeafter-item > div").addClass("cndkbeforeafter-drag-transition")}),p.find(".cndkbeforeafter-seperator").on("touchstart",function(e){v=!0,p.find(".cndkbeforeafter-seperator, .cndkbeforeafter-item > div").removeClass("cndkbeforeafter-drag-transition"),p.on("touchmove",function(e){var t=p.offset(),f=parseInt(e.touches[0].pageX-t.left),d=100*f/parseInt(r.width());p.find(".cndkbeforeafter-item-before-c").css("width",d+"%"),p.find(".cndkbeforeafter-item-after-c").css("width",100-d+"%"),p.find(".cndkbeforeafter-seperator").css("left",d+"%")})}),p.find(".cndkbeforeafter-seperator").append("<div><span></span></div>")}$(window).resize(function(){})})}(r)}};